<!DOCTYPE html><html>    <head>        <!-- 页面meta -->        <meta charset="utf-8">        <meta http-equiv="X-UA-Compatible" content="IE=edge">        <title>Springboot案例</title>        <meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" name="viewport">        <!-- 引入样式 -->        <link rel="stylesheet" href="../plugins/elementui/index.css">        <link rel="stylesheet" href="../plugins/font-awesome/css/font-awesome.min.css">        <link rel="stylesheet" href="../css/style.css">    </head>    <body class="hold-transition">        <div id="app">            <div class="content-header">                <h1>点名系统</h1>            </div>            <div class="app-container">                <div class="box">                    <div class="filter-container">                        <el-input placeholder="请输入学生的学号" clearable v-model.number="pagination.queryString" style="width: 200px;" class="filter-item" id="text"></el-input>                        <el-button  @click="getById()" class="butT" type="primary">搜索成员</el-button>                        <el-input v-model="inputStudentValue" style="width: 200px;" placeholder="请输入随机点名人数"></el-input>                        <el-button  @click="singIn()" class="butT" type="primary">随机点名</el-button>                        <el-button @click="getAll()" class="butT" type="primary">显示所有成员</el-button>                        <el-button type="primary" @click="abcdd()" class="butT">添加信息</el-button>                    </div>                    <el-table size="small" current-row-key="id" :data="dataList" stripe highlight-current-row>                        <el-table-column type="index" align="center" label="序号"></el-table-column>                        <el-table-column prop="sno" label="学号" align="center"></el-table-column>                        <el-table-column prop="name" label="姓名" align="center"></el-table-column>                        <el-table-column prop="remark" label="备注" align="center"></el-table-column>                        <el-table-column label="操作" align="center">                            <template slot-scope="scope">                                <el-button type="primary" size="mini" @click="handleUpdate(scope.row)">编辑</el-button>                                <el-button type="danger" size="mini" @click="handleDelete(scope.row)">删除</el-button>                            </template>                        </el-table-column>                    </el-table>                    <!-- 新增标签弹层 -->                    <!-- 添加成员表格区域 -->                    <el-dialog title="添加信息" :visible.sync="dialogVisibleAdd" @close="resetForm">                        <el-form :label-position="labelPosition" label-width="80px" :model="form">                            <el-form-item label="姓名">                                <el-input v-model="form.name"></el-input>                            </el-form-item>                            <el-form-item label="学号">                                <el-input v-model="form.sno"></el-input>                            </el-form-item>                            <el-form-item label="头像">                                <el-upload                                        class="avatar-uploader"                                        action="/students/image"                                        :show-file-list="false"                                        :on-success="handleAvatarSuccess"                                        :before-upload="beforeAvatarUpload">                                    <img v-if="imageUrl" :src="imageUrl" class="avatar">                                    <i v-else class="el-icon-plus avatar-uploader-icon"></i>                                </el-upload>                            </el-form-item>                                <el-button @click="dialogVisibleAdd = false">取 消</el-button>                                <el-button type="primary" @click="submitAddForm">确 定</el-button>                        </el-form>                    </el-dialog>                    <!-- 编辑标签弹层 -->                    <div class="add-form">                        <el-dialog title="编辑信息" :visible.sync="dialogFormVisible4Edit">                            <el-form ref="dataEditForm" :model="formDataEide" :rules="rules" label-position="right" label-width="100px">                                <el-row>                                    <el-col :span="12">                                        <el-form-item label="学号" prop="sno">                                            <el-input v-model="formDataEide.sno"/>                                        </el-form-item>                                    </el-col>                                    <el-col :span="12">                                        <el-form-item label="姓名" prop="name">                                            <el-input v-model="formDataEide.name"/>                                        </el-form-item>                                    </el-col>                                </el-row>                                <el-row>                                    <el-col :span="24">                                        <el-form-item label="备注">                                            <el-input v-model="formDataEide.remark" type="textarea"></el-input>                                        </el-form-item>                                    </el-col>                                </el-row>                            </el-form>                            <div slot="footer" class="dialog-footer">                                <el-button @click="dialogFormVisible4Edit = false">取消</el-button>                                <el-button type="primary" @click="handleEdit()">确定</el-button>                            </div>                        </el-dialog>                    </div>                        <el-row class="card-row">                            <el-col  :span="8" v-for="(items, index) in formData" :key="index" :v-if="visibleCard[index]">                                <el-card :body-style="{ padding: '5px' }" class="card">                                    <div class="image-container">                                        <img :src="imageUrl[index]" class="image">                                    </div>                                    <div class="card-info">                                        <span class="name">{{items.name}}:{{items.sno}}</span>                                        <div class="bottom clearfix">                                            <template>                                                <el-radio-group v-model="radio[index]">                                                    <el-radio :label="3">缺席</el-radio>                                                    <el-radio :label="9">迟到</el-radio>                                                    <el-radio :label="4">请假</el-radio>                                                </el-radio-group>                                            </template>                                            <el-button type="text" class="button" @click="submitInfoCard(index)">提交信息</el-button>                                        </div>                                    </div>                                </el-card>                            </el-col>                        </el-row>                </div>            </div>        </div>    </body>    <!-- 引入组件库 -->    <script src="../js/vue.js"></script>    <script src="../plugins/elementui/index.js"></script>    <script type="text/javascript" src="../js/jquery.min.js"></script>    <script src="../js/axios-0.18.0.js"></script>    <style scoped>        .time {            font-size: 13px;            color: #999;        }        .bottom {            margin-top: 13px;            line-height: 12px;        }        .button {            padding: 0;            float: right;        }        .image {            position: relative;            width: 50%;            left: 55px;            display: block;        }        .clearfix:before,        .clearfix:after {            display: table;            content: "";        }        .clearfix:after {            clear: both        }         .avatar-uploader .el-upload {             border: 1px dashed #d9d9d9;             border-radius: 6px;             cursor: pointer;             position: relative;             overflow: hidden;         }        .avatar-uploader .el-upload:hover {            border-color: #409EFF;        }        .avatar-uploader-icon {            font-size: 28px;            color: #8c939d;            width: 178px;            height: 178px;            line-height: 178px;            text-align: center;        }        .avatar {            width: 178px;            height: 178px;            display: block;        }    </style>    <script>        var vue = new Vue({            el: '#app',            data:{                testimageUrl: "9dee3113bc4d5db8039e85898410134.jpg",                radio: [],                imagUrl: [],                currentDate: new Date(),                pagination: {},				dataList: [],//当前页要展示的列表数据                formData: {},//表单数据                formDataEide:{},                dialogFormVisible: false,//控制表单是否可见                dialogFormVisible4Edit:false,//编辑表单是否可见                informationEide:false,                dialogVisibleCard:false,//随机抽取名单弹窗                dialogVisibleAdd: false,                form: {                    name: '',                    sno: '',                    avatar: ''                },                imageUrl: [],                rules: {//校验规则                    type: [{ required: true, message: '学号', trigger: 'blur' }],                    name: [{ required: true, message: '姓名', trigger: 'blur' }]                },                visibleCard:[],                inputStudentValue:''//输入框的值            },            //钩子函数，VUE对象初始化完成后自动执行            created() {                this.getAll();                for (let i = 0; i < this.formData.length; i++) {                    this.radio.push(0);                }            },            methods: {                // 提交表单数据                resetForm() {                    this.form.name = ''                    this.form.region = ''                    this.form.type = ''                    this.form.avatar = ''                    this.imageUrl = ''                },                abcdd() {                    this.dialogVisibleAdd = true                },                submitAddForm() {                    // console.log("提交数据")                    // console.log(this.imageUrl)                    // this.form.avatar=this.imageUrl                    console.log(this.form)                    axios.post("/students",this.form).then((res)=>{                        if(res.data.code == 20011){                            this.$message.success("保存成功")                            console.log(res.data)                        }                    })                    this.dialogVisibleAdd=false;                    // 提交表单数据                },                handleAvatarSuccess(response, file, fileList) {                    console.log('11',file)                    this.imageUrl = URL.createObjectURL(file.raw)                    console.log("this.imageUrl:"+this.imageUrl)                    // console.log("response.url"+response.url)                    console.log("res:"+response)                    this.form.avatar = response.data // 保存图片的地址到表单中                    // this.form.imageFile = file;                    // console.log("handleAvatarSuccesssT");                    // console.log(this.form.imageFile)                    console.log(URL.createObjectURL(file.raw))                    console.log(this.imageUrl)                    // console.log(response)                    console.log("form-avatar:"+this.form.avatar)                },                beforeAvatarUpload(file) {                    console.log("befor")                    console.log("avatar:    "+this.form.avatar)                    const isJPG = file.type === 'image/jpeg'                    const isPNG = file.type === 'image/png'                    if (!isJPG && !isPNG) {                        this.$message.error('上传头像图片只能是 JPG/PNG 格式!')                        return false                    }                    const isLt2M = file.size / 1024 / 1024 < 2                    if (!isLt2M) {                        this.$message.error('上传头像图片大小不能超过 2MB!')                        return false                    }                    return true                },                //列表                getAll() {                    //发送ajax请求                    axios.get("/students").then((res)=>{                        this.dataList = res.data.data;                        console.log(this.dataList[1].avatar)                    });                },                //随机点名                singIn(){                    this.dialogVisibleCard=true;                    console.log(this.inputStudentValue)                    let studentNum=this.inputStudentValue                    console.log(studentNum)                    axios.get("/students/singIn/"+this.inputStudentValue).then((res)=>{                        this.formData=res.data.data;                        this.dataList={};                        // this.dialogFormVisible4Edit=true;                        for (let i = 0; i <this.formData.length ; i++) {                          const obj=this.formData[i]                            // this.imagUrl[i]=obj.avatar;                            // this.imagUrl[i]=require("../image/"+this.$store.getters.userInfo.avatarUrl);                            // this.imagUrl[i]="../image/6dcacbf6b4a8740fbb4785edc573946.jpg"                            this.imageUrl[i]=obj.avatar;                          this.visibleCard[i]=true;                            console.log(this.visibleCard[i])                            console.log("this.imageUrl[i]:"+this.imageUrl[i])                        }                        console.log(this.formData)                    })                },                //随机点名卡片弹窗关闭                closeDialogCard(){                    this.dialogVisibleCard=false;                },                //提交考勤信息                submitInfoCard(index){                    // this.visibleCard[index]=false;                    // console.log(this.visibleCard[index])                    // const cardData = this.formData[index];                    this.formData[index].signInfo=this.radio[index]                    console.log(this.radio[index])                    console.log(this.formData[index])                    const cardData = this.formData[index];                    axios.post("/students/info",cardData).then((res)=>{                        if(res.data.code==20011){                            this.formData.splice(index, 1);                            this.imageUrl.splice(index, 1);                            this.radio.splice(index, 1);                            console.log("点击提交信息按钮")                        }else if(res.data.data==20010){                            this.$message.error("提交失败")                        }                    })                },                //id查询                getById(){                    let value=document.getElementById("text").value;                    console.log("xuehao"+value)                    if(value==null){                        this.$message.error("请输入学生的学号");                        return;                    }                       axios.get("/students/"+value).then((res)=>{                           console.log(res.data.data)                           this.formDataEide=res.data.data;                           if(res.data.code==20041){                               this.dialogFormVisible4Edit = true;                               this.$message.success("查询成功！");                           }else if(res.data.code==20040){                               this.$message.error("没有该学生信息！")                           }                       })                },                //弹出添加窗口                handleCreate() {                    this.dialogFormVisible = true;                    this.resetForm();                },                //重置表单                resetForm() {                    this.formData = {};                },                //添加                handleAdd () {                    //发送ajax请求                    axios.post("/students",this.formData).then((res)=>{                        console.log("输入的数据"+this.formData);                        //如果操作成功，关闭弹层，显示数据                        if(res.data.code == 20011){                            this.dialogFormVisible = false;                            this.$message.success("添加成功");                        }else if(res.data.code == 20010){                            this.$message.error("添加失败");                        }else{                            this.$message.error(res.data.msg);                        }                    }).finally(()=>{                        this.getAll();                    });                },                //弹出编辑窗口                handleUpdate(row) {                    console.log(row);                    // row.id 查询条件                    //查询数据，根据id查询                    // this.dialogFormVisible4Edit = true;                    axios.get("/students/"+row.sno).then((res)=>{                        // console.log(res.data.data);                        if(res.data.code == 20041){                            //展示弹层，加载数据                            this.formDataEide = res.data.data;                            console.log(this.formDataEide)                            this.dialogFormVisible4Edit = true;                        }else{                            this.$message.error(res.data.msg);                        }                    });                },                //编辑                handleEdit() {                    //发送ajax请求                    axios.put("/students",this.formDataEide).then((res)=>{                        //如果操作成功，关闭弹层，显示数据                        console.log(this.formDataEide)                        if(res.data.code == 20021){                            this.dialogFormVisible4Edit = false;                            this.$message.success("修改成功");                        }else if(res.data.code == 20020){                            this.$message.error("修改失败");                        }else{                            this.$message.error(res.data.msg);                        }                    }).finally(()=>{                        this.getAll();                    });                },                // 删除                handleDelete(row) {                    //1.弹出提示框                    this.$confirm("此操作永久删除当前数据，是否继续？","提示",{                        type:'info'                    }).then(()=>{                        //2.做删除业务                        axios.delete("/students/"+row.id).then((res)=>{                            if(res.data.code == 20031){                                this.$message.success("删除成功");                            }else{                                this.$message.error("删除失败");                            }                        }).finally(()=>{                            this.getAll();                        });                    }).catch(()=>{                        //3.取消删除                        this.$message.info("取消删除操作");                    });                }            }        })    </script></html>